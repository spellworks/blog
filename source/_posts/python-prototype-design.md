title: 在python实现中prototype设计模式
date: 2015-09-22 22:09:42
author: zeno
tags:
- zeno
- python
- monkey patch
---

这几天在看[《松本行弘的程序世界》](http://www.ituring.com.cn/book/727)，这本书主要讲语言设计。初学编程的人看了也会加深很多对计算机语言的理解。其中也有一笔讲到了23种设计模式，当我读到“原型模式”（prototype）时，惊讶地发现javascript在解决如何面向对象编程这个问题上就使用了这种灵巧的方案。但python并没有提供对prototype原生的支持。我顺便搜阅了下有没有别人已经实现了python的prototype模式。百度搜到的方法大都是直接使用python自带的`clone`库中深复制与浅复制的方法对对象进行复制，而对于关键的动态绑定属性和方法的办法，却完全没有提及。所以作为一个python菜鸟我打算自己实现一个，也可以练练手。
<!-- more -->

引用《设计模式》一书中的解释，Prototype模式“明确一个实例作为要声称对象的种类原型，通过复制该实例来生成新的对象”。粗略地解读，与通过类来生成实例这种传统的面向对象的实现方法不同，原型模式无需定义更加抽象的“类”，仅仅是通过已经定义好的实例，通过复制其本身的方式即可生成新的对象已达到复用的目的。较之通过类的方式实现面向对象更加灵动。在最著名的脚本语言javascript中，就仅仅是采用这种模式来实现面向对象。我觉得这是十分聪明的做法，对于javascript最经常使用的途径（页面脚本）中，需要专门的去定义一个类才能达到复用的目的无疑是臃肿的。说这么多，让我们用另一门支持原型模式的微型脚本语言Io来实际体会一下原型模式到底是怎样的吧：
```Io
Dog := Object clone  // 复制原型object
Dog sit := method("i'm siiting.\n" print)  // 狗会坐，所以给狗绑定“坐”的方法
myDog := Dog clone  // 从对象“狗”复制出对象“我的狗”
myDog sit  // 我的狗也会坐
myDog run := method("i'm running\n" print) // 我的狗还会跑，绑定“跑”方法
```
由此可见这是种多么省事的面向对象的实现方法啊。而且可以看出原型模式真正强大之处是只有动态语言才可以真正发挥的。动态地生成对象并且动态地为对象追加属性和方法，从而达到继承的目的。

初步了解了
